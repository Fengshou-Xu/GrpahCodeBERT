02/20/2024 21:25:10 - WARNING - __main__ -   device: cuda, n_gpu: 1
config.json:   0%|          | 0.00/539 [00:00<?, ?B/s]config.json: 100%|██████████| 539/539 [00:00<00:00, 2.76MB/s]
tokenizer_config.json:   0%|          | 0.00/25.0 [00:00<?, ?B/s]tokenizer_config.json: 100%|██████████| 25.0/25.0 [00:00<00:00, 154kB/s]
vocab.json:   0%|          | 0.00/899k [00:00<?, ?B/s]vocab.json: 100%|██████████| 899k/899k [00:00<00:00, 45.7MB/s]
merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]merges.txt: 100%|██████████| 456k/456k [00:00<00:00, 18.8MB/s]
special_tokens_map.json:   0%|          | 0.00/772 [00:00<?, ?B/s]special_tokens_map.json: 100%|██████████| 772/772 [00:00<00:00, 4.42MB/s]
pytorch_model.bin:   0%|          | 0.00/499M [00:00<?, ?B/s]pytorch_model.bin:   8%|▊         | 41.9M/499M [00:00<00:01, 381MB/s]pytorch_model.bin:  17%|█▋        | 83.9M/499M [00:00<00:01, 395MB/s]pytorch_model.bin:  25%|██▌       | 126M/499M [00:00<00:01, 370MB/s] pytorch_model.bin:  34%|███▎      | 168M/499M [00:00<00:00, 368MB/s]pytorch_model.bin:  44%|████▍     | 220M/499M [00:00<00:00, 399MB/s]pytorch_model.bin:  55%|█████▍    | 273M/499M [00:00<00:00, 422MB/s]pytorch_model.bin:  65%|██████▌   | 325M/499M [00:00<00:00, 437MB/s]pytorch_model.bin:  76%|███████▌  | 377M/499M [00:00<00:00, 438MB/s]pytorch_model.bin:  86%|████████▌ | 430M/499M [00:01<00:00, 421MB/s]pytorch_model.bin:  97%|█████████▋| 482M/499M [00:01<00:00, 406MB/s]pytorch_model.bin: 100%|██████████| 499M/499M [00:01<00:00, 403MB/s]
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/graphcodebert-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.out_proj.bias', 'classifier.dense.bias', 'classifier.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
02/20/2024 21:25:17 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='dataset/train.txt', output_dir='saved_models', eval_data_file='dataset/valid.txt', test_data_file='dataset/test.txt', model_name_or_path='microsoft/graphcodebert-base', config_name='microsoft/graphcodebert-base', tokenizer_name='microsoft/graphcodebert-base', code_length=512, data_flow_length=128, do_train=False, do_eval=True, do_test=True, evaluate_during_training=True, train_batch_size=16, eval_batch_size=32, gradient_accumulation_steps=1, learning_rate=2e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=123456, epochs=1, n_gpu=1, device=device(type='cuda'))
02/20/2024 21:25:28 - INFO - __main__ -   Creating features from index file at dataset/valid.txt 
  0%|          | 0/41541 [00:00<?, ?it/s]  0%|          | 1/41541 [00:00<6:56:48,  1.66it/s]  0%|          | 6/41541 [00:00<1:03:51, 10.84it/s]  0%|          | 14/41541 [00:00<27:46, 24.92it/s]   0%|          | 21/41541 [00:00<21:12, 32.63it/s]  0%|          | 26/41541 [00:01<23:31, 29.41it/s]  0%|          | 32/41541 [00:01<19:38, 35.23it/s]  0%|          | 38/41541 [00:01<17:17, 40.02it/s]  0%|          | 43/41541 [00:01<17:28, 39.59it/s]  0%|          | 48/41541 [00:01<20:21, 33.96it/s]  0%|          | 55/41541 [00:01<16:31, 41.83it/s]  0%|          | 62/41541 [00:01<14:20, 48.23it/s]  0%|          | 68/41541 [00:02<17:09, 40.27it/s]  0%|          | 75/41541 [00:02<14:47, 46.71it/s]  0%|          | 86/41541 [00:02<12:12, 56.59it/s]  0%|          | 93/41541 [00:02<12:33, 55.03it/s]  0%|          | 99/41541 [00:02<14:15, 48.47it/s]  0%|          | 105/41541 [00:02<14:24, 47.92it/s]  0%|          | 111/41541 [00:03<18:18, 37.71it/s]  0%|          | 117/41541 [00:03<16:41, 41.35it/s]  0%|          | 122/41541 [00:03<16:13, 42.57it/s]  0%|          | 127/41541 [00:03<18:43, 36.87it/s]  0%|          | 138/41541 [00:03<13:29, 51.17it/s]  0%|          | 147/41541 [00:03<11:45, 58.64it/s]  0%|          | 154/41541 [00:03<11:15, 61.31it/s]  0%|          | 161/41541 [00:03<11:16, 61.17it/s]  0%|          | 170/41541 [00:03<10:07, 68.13it/s]  0%|          | 180/41541 [00:04<09:13, 74.75it/s]  0%|          | 188/41541 [00:04<10:05, 68.31it/s]  0%|          | 196/41541 [00:04<14:05, 48.88it/s]  0%|          | 203/41541 [00:04<13:02, 52.84it/s]  1%|          | 216/41541 [00:04<10:57, 62.82it/s]  1%|          | 227/41541 [00:04<10:02, 68.55it/s]  1%|          | 240/41541 [00:05<08:29, 81.00it/s]  1%|          | 249/41541 [00:05<08:57, 76.80it/s]  1%|          | 261/41541 [00:05<07:55, 86.89it/s]  1%|          | 271/41541 [00:05<12:09, 56.56it/s]  1%|          | 279/41541 [00:05<12:05, 56.85it/s]  1%|          | 295/41541 [00:05<09:05, 75.64it/s]  1%|          | 305/41541 [00:06<10:26, 65.80it/s]  1%|          | 323/41541 [00:06<07:50, 87.67it/s]  1%|          | 338/41541 [00:06<07:00, 97.87it/s]  1%|          | 350/41541 [00:06<07:34, 90.55it/s]  1%|          | 363/41541 [00:06<07:06, 96.63it/s]  1%|          | 376/41541 [00:06<06:48, 100.78it/s]  1%|          | 391/41541 [00:06<08:09, 84.15it/s]   1%|          | 401/41541 [00:07<09:20, 73.37it/s]  1%|          | 413/41541 [00:07<08:22, 81.83it/s]  1%|          | 423/41541 [00:07<08:51, 77.33it/s]  1%|          | 444/41541 [00:07<06:31, 105.04it/s]  1%|          | 456/41541 [00:07<06:31, 105.04it/s]  1%|          | 468/41541 [00:07<07:28, 91.54it/s]   1%|          | 494/41541 [00:07<05:17, 129.34it/s]  1%|          | 519/41541 [00:07<04:24, 154.90it/s]  1%|▏         | 537/41541 [00:08<05:16, 129.37it/s]  1%|▏         | 558/41541 [00:08<04:45, 143.53it/s]  1%|▏         | 585/41541 [00:08<03:58, 171.71it/s]  1%|▏         | 617/41541 [00:08<03:22, 201.77it/s]  2%|▏         | 639/41541 [00:08<03:29, 195.39it/s]  2%|▏         | 664/41541 [00:08<03:18, 205.85it/s]  2%|▏         | 700/41541 [00:08<02:47, 243.46it/s]  2%|▏         | 733/41541 [00:08<02:33, 266.54it/s]  2%|▏         | 761/41541 [00:09<02:38, 257.98it/s]  2%|▏         | 807/41541 [00:09<02:14, 303.40it/s]  2%|▏         | 838/41541 [00:09<02:14, 303.10it/s]  2%|▏         | 871/41541 [00:09<02:11, 309.69it/s]  2%|▏         | 903/41541 [00:09<02:47, 241.93it/s]  2%|▏         | 948/41541 [00:09<02:19, 291.05it/s]  2%|▏         | 1019/41541 [00:09<01:42, 395.63it/s]  3%|▎         | 1075/41541 [00:09<01:38, 411.34it/s]  3%|▎         | 1140/41541 [00:09<01:27, 464.34it/s]  3%|▎         | 1273/41541 [00:10<00:58, 694.09it/s]  3%|▎         | 1415/41541 [00:10<00:45, 885.12it/s]  4%|▍         | 1647/41541 [00:10<00:35, 1112.47it/s]  5%|▍         | 1908/41541 [00:10<00:26, 1485.38it/s] 10%|█         | 4330/41541 [00:10<00:04, 7532.80it/s] 12%|█▏        | 5154/41541 [00:10<00:05, 6689.96it/s] 92%|█████████▏| 38170/41541 [00:10<00:00, 88783.45it/s]100%|██████████| 41541/41541 [00:10<00:00, 3843.11it/s] 
02/20/2024 21:25:42 - INFO - __main__ -   ***** Running evaluation *****
02/20/2024 21:25:42 - INFO - __main__ -     Num examples = 41541
02/20/2024 21:25:42 - INFO - __main__ -     Batch size = 32
02/20/2024 21:38:05 - INFO - __main__ -   ***** Eval results *****
02/20/2024 21:38:05 - INFO - __main__ -     eval_f1 = 0.9257
02/20/2024 21:38:05 - INFO - __main__ -     eval_precision = 0.9294
02/20/2024 21:38:05 - INFO - __main__ -     eval_recall = 0.9219
02/20/2024 21:38:05 - INFO - __main__ -     eval_threshold = 0.5
02/20/2024 21:38:06 - INFO - __main__ -   Creating features from index file at dataset/test.txt 
  0%|          | 0/415416 [00:00<?, ?it/s]  0%|          | 10/415416 [00:00<1:13:16, 94.48it/s]  0%|          | 20/415416 [00:00<1:33:49, 73.80it/s]  0%|          | 28/415416 [00:00<1:35:01, 72.85it/s]  0%|          | 36/415416 [00:00<1:41:29, 68.21it/s]  0%|          | 43/415416 [00:00<1:49:06, 63.45it/s]  0%|          | 50/415416 [00:00<1:51:51, 61.89it/s]  0%|          | 57/415416 [00:00<2:00:15, 57.57it/s]  0%|          | 66/415416 [00:00<1:45:45, 65.46it/s]  0%|          | 76/415416 [00:01<1:34:31, 73.24it/s]  0%|          | 84/415416 [00:01<1:32:23, 74.93it/s]  0%|          | 92/415416 [00:01<1:32:20, 74.96it/s]  0%|          | 101/415416 [00:01<1:29:29, 77.34it/s]  0%|          | 109/415416 [00:01<1:34:16, 73.43it/s]  0%|          | 117/415416 [00:01<1:56:32, 59.39it/s]  0%|          | 124/415416 [00:01<2:18:27, 49.99it/s]  0%|          | 131/415416 [00:02<2:10:06, 53.20it/s]  0%|          | 141/415416 [00:02<1:54:18, 60.55it/s]  0%|          | 148/415416 [00:02<2:56:34, 39.20it/s]  0%|          | 157/415416 [00:02<2:25:40, 47.51it/s]  0%|          | 165/415416 [00:02<2:11:02, 52.82it/s]  0%|          | 174/415416 [00:02<2:00:13, 57.56it/s]  0%|          | 183/415416 [00:03<1:58:23, 58.46it/s]  0%|          | 193/415416 [00:03<1:44:24, 66.28it/s]  0%|          | 201/415416 [00:03<1:59:20, 57.99it/s]  0%|          | 208/415416 [00:03<2:00:11, 57.58it/s]  0%|          | 216/415416 [00:03<1:50:17, 62.75it/s]  0%|          | 231/415416 [00:03<1:23:35, 82.78it/s]  0%|          | 244/415416 [00:03<1:14:59, 92.27it/s]  0%|          | 254/415416 [00:03<1:20:10, 86.30it/s]  0%|          | 264/415416 [00:04<1:21:53, 84.49it/s]  0%|          | 275/415416 [00:04<1:16:12, 90.79it/s]  0%|          | 291/415416 [00:04<1:03:56, 108.20it/s]  0%|          | 303/415416 [00:04<1:09:06, 100.11it/s]  0%|          | 315/415416 [00:04<1:06:37, 103.84it/s]  0%|          | 326/415416 [00:04<1:12:57, 94.83it/s]   0%|          | 337/415416 [00:04<1:10:35, 98.00it/s]  0%|          | 357/415416 [00:04<55:22, 124.94it/s]   0%|          | 373/415416 [00:04<52:45, 131.13it/s]  0%|          | 394/415416 [00:05<47:26, 145.80it/s]  0%|          | 409/415416 [00:05<55:23, 124.86it/s]  0%|          | 423/415416 [00:05<59:59, 115.29it/s]  0%|          | 437/415416 [00:05<57:05, 121.16it/s]  0%|          | 450/415416 [00:05<57:51, 119.55it/s]  0%|          | 480/415416 [00:05<41:46, 165.51it/s]  0%|          | 498/415416 [00:05<42:37, 162.22it/s]  0%|          | 515/415416 [00:05<44:12, 156.43it/s]  0%|          | 532/415416 [00:06<45:26, 152.16it/s]  0%|          | 553/415416 [00:06<43:12, 160.03it/s]  0%|          | 588/415416 [00:06<33:01, 209.36it/s]  0%|          | 614/415416 [00:06<31:09, 221.82it/s]  0%|          | 639/415416 [00:06<36:02, 191.83it/s]  0%|          | 680/415416 [00:06<28:15, 244.55it/s]  0%|          | 707/415416 [00:06<29:37, 233.30it/s]  0%|          | 744/415416 [00:06<25:55, 266.54it/s]  0%|          | 772/415416 [00:06<27:34, 250.58it/s]  0%|          | 799/415416 [00:07<29:52, 231.27it/s]  0%|          | 849/415416 [00:07<23:15, 297.07it/s]  0%|          | 918/415416 [00:07<17:28, 395.40it/s]  0%|          | 971/415416 [00:07<16:07, 428.50it/s]  0%|          | 1016/415416 [00:07<18:15, 378.17it/s]  0%|          | 1121/415416 [00:07<12:52, 536.36it/s]  0%|          | 1214/415416 [00:07<10:49, 638.09it/s]  0%|          | 1282/415416 [00:08<14:02, 491.27it/s]  0%|          | 1380/415416 [00:08<11:34, 596.23it/s]  0%|          | 1479/415416 [00:08<10:21, 665.74it/s]  0%|          | 1683/415416 [00:08<06:51, 1006.46it/s]  0%|          | 2052/415416 [00:08<04:06, 1679.55it/s]  1%|          | 2843/415416 [00:08<02:05, 3280.27it/s]  5%|▍         | 20046/415416 [00:08<00:12, 32238.55it/s] 14%|█▍        | 57947/415416 [00:08<00:03, 102649.71it/s] 23%|██▎       | 96554/415416 [00:09<00:01, 166374.21it/s] 29%|██▉       | 120905/415416 [00:09<00:02, 120554.99it/s] 39%|███▊      | 160870/415416 [00:09<00:01, 172031.78it/s] 48%|████▊     | 201050/415416 [00:09<00:00, 219946.97it/s] 58%|█████▊    | 241620/415416 [00:09<00:00, 262579.58it/s] 66%|██████▌   | 273811/415416 [00:10<00:00, 166104.56it/s] 76%|███████▌  | 313916/415416 [00:10<00:00, 207095.76it/s] 85%|████████▌ | 353820/415416 [00:10<00:00, 245390.82it/s] 95%|█████████▍| 394443/415416 [00:10<00:00, 281062.57it/s]100%|██████████| 415416/415416 [00:10<00:00, 38712.65it/s] 
02/20/2024 21:38:18 - INFO - __main__ -   ***** Running Test *****
02/20/2024 21:38:18 - INFO - __main__ -     Num examples = 415416
02/20/2024 21:38:18 - INFO - __main__ -     Batch size = 32
